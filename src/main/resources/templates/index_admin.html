<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6">
<head>
    <meta charset="UTF-8">
    <title>Inicio</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
          integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
          crossorigin="anonymous">
</head>
<body>

<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container">
        <div class="navbar-header">
            <a class="navbar-brand" href="#" th:href="@{/}">Registro y Login</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
                <li sec:authorize="isAuthenticated()">
                    <form th:action="@{/logout}" method="post">
                        <button type="submit" class="btn btn-link navbar-btn">Cerrar sesión</button>
                    </form>
                </li>
            </ul>
        </div>
    </div>
</nav>

<br><br>

<div class="container">
    <div class="row">
        <div class="col-md-6 col-md-offset-3">
            <h1>Bienvenido a la página de inicio</h1>
            <p>Has iniciado sesión correctamente.</p>
            <div sec:authorize="hasRole('ROLE_ADMIN')">
                <p>Eres un administrador. <a th:href="@{/admin/usuarios}">Ver usuarios</a></p>
            </div>
            <div sec:authorize="hasRole('ROLE_USER')">
                <p>Eres un usuario normal.</p>
            </div>
        </div>
    </div>
</div>

<div class="container my-5">
    <h2>Mi Perfil</h2>
    <div class="card">
        <div class="card-body">
            <table class="table table-striped table-bordered">
                <tbody>
                    <tr>
                        <th style="width: 30%;">Nombre de Usuario</th>
                        <!-- Usamos la propiedad nombreUsuario de la entidad [7] -->
                        <td th:text="${usuarioActual.nombreUsuario}"></td>
                    </tr>
                    <tr>
                        <th>Nombre Completo</th>
                        <td th:text="${usuarioActual.nombre} + ' ' + ${usuarioActual.apellidos}"></td>
                    </tr>
                    <tr>
                        <th>Correo Electrónico</th>
                        <td th:text="${usuarioActual.email}"></td>
                    </tr>
                    <tr>
                        <th>Roles Asignados</th>
                        <td>
                            <!-- Iteramos sobre la colección 'roles' [7] para mostrar cada nombre de rol -->
                            <span th:each="rol : ${usuarioActual.roles}">
                                <span th:text="${rol.nombre}" class="badge bg-secondary"></span>
                            </span>
                        </td>
                    </tr>
                    <tr>
                        <th>Estado de Cuenta</th>
                        <!-- Comprobamos la propiedad 'bloqueado' [8] -->
                        <td th:if="${usuarioActual.bloqueado}" class="text-danger">BLOQUEADA</td>
                        <td th:if="${!usuarioActual.bloqueado}" class="text-success">Activa</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>



</body>
</html>